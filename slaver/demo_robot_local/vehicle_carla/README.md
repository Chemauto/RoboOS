# Vehicle CARLA Skill Module

**创建时间**: 2026-01-15 13:50 CST

## 目录结构说明

```
vehicle_carla/
├── __init__.py          # Python模块标识
├── skill.py             # MCP注册入口（待创建）
├── config.yaml          # 配置文件（待创建）
├── skills/              # 功能实现目录
│   ├── __init__.py
│   ├── control.py       # 车辆控制功能（待创建）
│   ├── sensor.py        # 传感器数据功能（待创建）
│   └── simulation.py    # 仿真管理功能（待创建）
└── utils/               # 辅助工具
    ├── __init__.py      # ✅ 已创建
    ├── udp_client.py    # ✅ 已创建 - UDP通信客户端
    └── logger.py        # ✅ 已创建 - 日志工具
```

## 为什么这样组织？

### 1. skill.py - MCP注册入口
**作用**: 轻量级的注册文件，只负责将功能注册为MCP tools
**优势**:
- 保持简洁，易于理解
- 修改功能实现不需要改动注册代码
- 清晰的接口定义

### 2. skills/ - 功能实现目录
**作用**: 按功能类别组织实际实现代码
**优势**:
- **control.py**: 车辆控制相关（5个skills）
  - 代码集中，易于维护
  - 共享状态管理（如当前控制状态）
- **sensor.py**: 传感器数据相关（3个skills）
  - 数据处理逻辑独立
  - 可以添加数据缓存
- **simulation.py**: 仿真管理相关（3个skills）
  - 仿真生命周期管理
  - 状态监控

### 3. utils/ - 辅助工具
**作用**: 提供可复用的通用功能
**优势**:
- **udp_client.py**: UDP通信封装
  - 统一的通信接口
  - 错误处理集中
  - 易于测试和mock
- **logger.py**: 日志工具
  - 统一的日志格式
  - 便于调试和追踪
  - 可以轻松切换日志级别

### 4. config.yaml - 配置文件
**作用**: 集中管理配置参数
**优势**:
- 网络地址、端口等参数可配置
- 不需要修改代码就能调整参数
- 便于不同环境切换

## 设计优势

### ✅ 易于调试
1. **模块独立**: 每个文件职责单一，问题定位快
2. **日志完善**: 统一的日志系统，操作可追踪
3. **错误隔离**: 一个模块出错不影响其他模块

### ✅ 易于管理
1. **添加新功能**: 只需在对应skills文件添加函数，然后在skill.py注册
2. **修改功能**: 直接修改skills文件，不影响其他功能
3. **配置管理**: 所有配置集中在config.yaml

### ✅ 易于测试
1. **单元测试**: 每个模块可以独立测试
2. **Mock测试**: UDP通信可以mock，不需要真实CARLA
3. **集成测试**: 可以逐步测试各个模块

### ✅ 可扩展性
1. **添加新工具**: 在utils/添加新文件
2. **添加新功能类别**: 在skills/添加新文件
3. **不影响现有代码**: 新功能独立开发

## 与demo_robot_local的对比

### demo_robot_local（简单模式）
```
demo_robot_local/
├── skill.py          # 所有功能都在一个文件
└── config.yaml
```
- ✅ 简单直接
- ❌ 功能多了难以维护
- ❌ 调试困难

### vehicle_carla（模块化模式）
```
vehicle_carla/
├── skill.py          # 只负责注册
├── skills/           # 功能分类实现
└── utils/            # 工具复用
```
- ✅ 结构清晰
- ✅ 易于维护
- ✅ 便于调试
- ✅ 可扩展

## 下一步

1. 创建 `skills/control.py` - 实现车辆控制功能
2. 创建 `skills/sensor.py` - 实现传感器数据功能
3. 创建 `skills/simulation.py` - 实现仿真管理功能
4. 创建 `skill.py` - 注册所有skills到MCP
5. 创建 `config.yaml` - 配置参数
6. 测试验证
